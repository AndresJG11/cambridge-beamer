% Use the grid pitches from 
% http://www.admin.cam.ac.uk/offices/communications/services/identityguidelines/guidelines-graphiclanguage.pdf
% 
% In essence we want the vertical pitch to be such that there are 30 steps.
% This is based on the PowerPoint template sizes.
%
\newlength{\cam@outer@pitch} \setlength{\cam@outer@pitch}{0.0333333\paperheight} 

\setbeamersize{text margin left=2\cam@outer@pitch}
\setbeamersize{text margin right=2\cam@outer@pitch}

\setbeamerfont{section in head/foot}{size=\Large}
\setbeamerfont{logo in head/foot}{parent=subsection in head/foot}

\setbeamerfont{progress}{size=\tiny}
\setbeamercolor{progress}{fg=structure.fg!50}

% The University logo
\pgfdeclareimage[height=1.5\cam@outer@pitch]{beamerlogocambridge}{uc-rev-cmyk}

\mode<presentation>

% Navigation symbols
\defbeamertemplate*{navigation symbols}{cambridge theme}{}

% background

\defbeamertemplate*{background}{cambridge theme}
{}

% Headline and footline

\defbeamertemplate*{frametitle}{cambridge theme}
{%
  \vskip-1pt % HACK: Removes a bright line at the top of the page.
  \begin{beamercolorbox}[wd=\paperwidth,ht=4.5\cam@outer@pitch,dp=\cam@outer@pitch,leftskip=2\cam@outer@pitch,sep=0pt]{palette primary}%
    \begin{beamercolorbox}[ht=0pt,sep=0pt]{}%
      \usebeamerfont{frametitle}\insertframetitle
    \end{beamercolorbox}
  \end{beamercolorbox}%
  \nointerlineskip
  \begin{beamercolorbox}[wd=\paperwidth,dp=0.5\cam@outer@pitch]{lower separation line head}%
  \end{beamercolorbox}%
}

\defbeamertemplate*{footprogress}{cambridge theme}
{%
  \usebeamerfont{progress}\usebeamercolor[fg]{progress}\insertframenumber\ of \inserttotalframenumber
}

%\defbeamertemplate*{footprogress}{cambridge theme}
%{%
%\begin{tikzpicture}[x=\cam@outer@pitch,y=\cam@outer@pitch]
%   \draw[step=0.5,gray,very thin] (-1.4,-1.4) grid (1.4,1.4); 
%   \draw (-1.5,0) -- (1.5,0);
%   \draw (0,-1.5) -- (0,1.5);
%   \draw (0,0) circle (1); \draw (0.3,0) arc (0:30:0.3);
%\end{tikzpicture}
%
% % \insertframenumber\ of \inserttotalframenumber
%}

\defbeamertemplate*{footline}{cambridge theme}
{
  \ifx \insertframetitle \@empty
    % There was no frame title
  \else
    % There was a frame title, typeset the counterpart to the frame title (this is a hack).
    \begin{beamercolorbox}[sep=0.5\cam@outer@pitch,leftskip=1.5\cam@outer@pitch,rightskip=0.5\cam@outer@pitch]{palette secondry}%
      \usebeamerfont{logo in head/foot}\insertlogo
      \hfill
      \hbox{\usebeamertemplate{footprogress}}
    \end{beamercolorbox}%
  \fi
}


% Sidebar

\defbeamertemplate*{sidebar left}{cambridge theme}
{}

\defbeamertemplate*{sidebar right}{cambridge theme}
{}

\defbeamertemplate*{sidebar canvas left}{cambridge theme}
{}

\defbeamertemplate*{sidebar canvas right}{cambridge theme}
{}

\mode<all>

\ifbeamertemplateempty{logo}{%
   \setbeamertemplate{logo}{%
      \pgfuseimage{beamerlogocambridge}
   }
}{%
   % Do nothing if logo is set.
}
